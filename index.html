<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skole-Spotify | Playliste Viser</title>
    <style>
        :root { --spotify-green: #1DB954; --bg-black: #121212; --card-bg: #181818; --input-bg: #282828; --text-main: #ffffff; --text-sub: #b3b3b3; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background-color: var(--bg-black); color: var(--text-main); display: flex; flex-direction: column; align-items: center; margin: 0; padding: 15px; }
        .container { background-color: var(--card-bg); padding: 1.2rem; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.5); width: 100%; max-width: 450px; text-align: center; margin-bottom: 10px; }
        h2 { color: var(--spotify-green); margin: 0 0 12px 0; font-size: 1.1rem; }
        .input-group { display: flex; gap: 8px; margin-bottom: 10px; }
        input { flex: 1; padding: 10px; border-radius: 6px; border: 1px solid #333; background: var(--input-bg); color: white; font-size: 0.9rem; outline: none; }
        .btn-main { background-color: var(--spotify-green); color: white; border: none; padding: 10px 18px; border-radius: 50px; font-weight: bold; cursor: pointer; font-size: 0.85rem; }
        #status-area { font-size: 0.75rem; color: var(--text-sub); border-top: 1px solid #333; padding-top: 8px; margin-top: 5px; }
        #status-area a { color: var(--spotify-green); text-decoration: none; font-weight: bold; }
        #embed-container { width: 100%; max-width: 800px; min-height: 500px; margin-top: 10px; }
        .suggestions { margin-top: 20px; text-align: center; width: 100%; }
        .suggestion-grid { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; }
        .suggest-btn { background: var(--input-bg); color: white; border: 1px solid #444; padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; cursor: pointer; }
        .suggest-btn:hover { background: var(--spotify-green); border-color: var(--spotify-green); }
        .error { color: #ff5252; font-size: 0.8rem; margin-top: 5px; display: none; }
    </style>
</head>
<body>

<div class="container">
    <h2>IndsÃ¦t din playliste her</h2>
    <div class="input-group">
        <input type="text" id="playlistInput" placeholder="SÃ¦t link eller ID ind her...">
        <button class="btn-main" onclick="embedPlaylist()">Afspil</button>
    </div>
    <div id="status-area">
        Loginstatus: <a href="https://accounts.spotify.com/da/login" target="_blank">[Klik her for at logge ind]</a>
    </div>
    <div id="errorMessage" class="error">Ugyldigt link eller ID. PrÃ¸v igen.</div>
</div>

<div id="embed-container"></div>

<div class="suggestions">
    <div class="suggestion-grid">
        <button class="suggest-btn" onclick="loadSuggested('37i9dQZEVXbMw2iUtFR5Eq')">ðŸ‡©ðŸ‡° Top 50</button>
        <button class="suggest-btn" onclick="loadSuggested('37i9dQZF1DX8Uebhn9wzrS')">â˜• Lofi</button>
        <button class="suggest-btn" onclick="loadSuggested('37i9dQZF1DX4WYpdgoIcn6')">ðŸŒ¿ Chill</button>
        <button class="suggest-btn" onclick="loadSuggested('37i9dQZF1EIenKoRYMAPGb')">ðŸŽ¤ Pop</button>
    </div>
</div>

<script>
    window.onload = function() {
        const hashId = window.location.hash.substring(1);
        if (hashId) { loadSuggested(hashId); }
    };

    function processInput(input) {
        let playlistId = '';
        const cleanInput = input.trim();
        if (cleanInput.includes('playlist/')) {
            playlistId = cleanInput.split('playlist/')[1].split('?')[0];
        } else if (cleanInput.length >= 15 && /^[a-zA-Z0-9]+$/.test(cleanInput)) {
            playlistId = cleanInput;
        }
        return playlistId;
    }

    function embedPlaylist(forcedId = null) {
        const id = forcedId || processInput(document.getElementById('playlistInput').value);
        const container = document.getElementById('embed-container');
        if (id) {
            document.getElementById('errorMessage').style.display = 'none';
            // VIGTIGT: URL'en er Ã¦ndret til det nye format og indeholder 'allow' parametre
            container.innerHTML = `
                <iframe 
                    style="border-radius:12px" 
                    src="https://open.spotify.com/embed/playlist/...2{id}?utm_source=generator" 
                    width="100%" 
                    height="500" 
                    frameBorder="0" 
                    allowfullscreen="" 
                    allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" 
                    loading="lazy">
                </iframe>`;
            window.location.hash = id;
        } else {
            document.getElementById('errorMessage').style.display = 'block';
        }
    }

    function loadSuggested(id) {
        document.getElementById('playlistInput').value = id;
        embedPlaylist(id);
    }

    document.getElementById('playlistInput').addEventListener('keypress', function (e) {
        if (e.key === 'Enter') embedPlaylist();
    });
</script>

</body>
</html>
